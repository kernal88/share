Ionospheric refraction
In the ionosphere which is 50 ~ 100 km from the ground, 
strong ionization generates a large amount of free electrons and positive ions from air 
molecules by celestial radiation. When the GPS signals go through the ionosphere, like 
other electromagnetic waves, the signal path will bend, the velocity will change, so that 
,the distance measurement error occurs. This is known as ionospheric refraction.
Three ways to weaken its influence are available nowadays:
1. Using dual-frequency observations. Using a combination of observations at different 
   frequencies to correct.
2. Using the ionospheric model.
3. Find difference between the simultaneous observations. This method is great for 
   short-baseline.

Tropospheric refraction
The troposphere is the lowest portion of Earth's atmosphere, 
which contains approximately 80% of the atmosphere's mass and 99% of its water vapor and 
aerosols. The average depth of the troposphere is approximately 17 km. And the atmospheric 
conditions are more complex. The troposphere gets radiation from the ground, and the 
temperature decreases with increasing height. Like what happens in the ionosphere, through 
the troposphere the GPS signal path also bend, so that the distance measurement error 
occurs again. This is tropospheric refraction.
There also three ways to weaken the influence:
1. Using the tropospheric model, whose meteorological parameters measured in the station directly.
2. Introduction the additional parameters describing the influence of the troposphere, 
   which to be estimated during data process.
3. Find difference between the simultaneous observations.

Ren Yafei and Ke Xizheng proposed one kind of simple troposphere delay revision model applied under the condition of lacking
of the actual measured meteorological parameters, based on Hopfield model and Saastamoinen model. They use Matlab to analyze 
the real measured data by the static and dynamic receivers. The experimental results indicate that the simply-revised 
model can eliminate 70% of troposphere delay effects, and the GPS positioning accuracy can be effectively imporved.


Multipath
GPS receiver receives normal signals from satellites, and reflective signals through 
buildings, water or other reflective surface. The latter is interference, which has 
longer path, producing the so called "multi-path error". Such interference and delay 
effects caused by multi-path signal propagation is called multipath.
Ways to suppress the influence:
1. Select appropriate stations. Stations should not be in hills, valleys and basins, 
   should leave the high-rise buildings.
2. Choose better receiver antenna.


《多路径效应对GPS定位影响的研究》
不确定的  诱导电流 整周数
    Guo Jingjun, Shang Ruibin, Li Yulin made a research of the multipath generated by different materials.
The multipath has some relationship with satellite vertical angle and the distance from reflectors to antenna. In diagram 1, 'D' is the distance,
'sigma' is the satellite vertical angle. The antenna gets signal L1 which is from satellite, and signal L2 which walks along S2 and S1.
It's easy to find out that:
    S1 = D / cos'sigma' 
    S2 = S1 * cos2'sigma'
    S = S1 + S2 (S is delay)
    Q = S / 'lambda' (Q is delay phase)

    In diagram 2, it's the vector diagram of direct wave adding reflected wave. B is the direct, while A is the reflected, of course C is the compound:
    epsilon = arct.....
    Q is the phase dielectric between the original and the reflected
    'psi' is the phase difference between the original and the compound
    A is the swing of the reflected wave
    B is the swing of the direct wave
    C is the swing of the compound wave
'psi' can make measurement errors in two ways. One is 整周, the other is the part which not exceeding a 整周
In the formula, Q has relationship with incoming angle, A has relationship with the reflective media and the distance between antenna and the media.
To say it more precisely, resistivity effects A when the reflector is metal, dielectric constant effects A when it's dielectric. Inside a conductor, 
the current is running, not leading to the pile of electricity. Only can we find electricity on conductor surface, and they flow the rule of exponential
attenuation. The attenuation has relationship with satellite vertical angle ('sigma') and dielectric constant ('epsilon'). 'sigma' is larger attenuation
is quicker, while 'epsilon' is larger attenuation is slower. Larger 'epsilon' means that the media is more powerful to restrict electricity, so that
the eletric field has smaller divergence, leading to the slower attenuation. So full reflection happens when metals taking place.

    诱导current and electricity (including internal 诱导current, surface 诱导current, surface astricted electricity) will be generated on dielectric 
when wave coming. When the surface 线度 is much larger than then wavelength, these current and electricity will generate reflected wave, finally generate
refracted wave adding with the original incoming wave. The reflected and the refracted have something in common, for example same frequency and wavelength
with the original, incoming angle is equal to the reflected angle. When incoming angle plus refracted angle equals to 'pai'/2, the incoming wave won't
reflect. When incoming angle approximates to 'pai'/2, almost all energy reflects. The formula below shows the relationship between dielectric constant and
transmissivity:
    'eta' = 'lambda' / 'epsilon'
Little 'epsilon' leads to little reflection, meanwhile huge transmissivity. Air's is 1.
We can check the dielectric constants of normal objects easily. Water is more than 60, so water is able to reflect a lot. Sand, soil and woods are about
from 3 to 9, much smaller than water. When they are wet, namely in rain environment, the constants become larger.

    They choose woods, metals, glass and so forth as different reflectors.
According to their experiments, woods and metals can reflect GPS signals while glass does not.
The dielectric constant of woods is 6.7, which of glass is just 3.5. Wood block could effect the positioning result
in decimeter level. The multipath is definitely effected by surrounding objects, especially for metals. Because metals
can reflect electromagnetic wave totally. So antenna always has anti-metal board to suppress their influence.
The multipath of nonmetal materials are according to their dielectric constants. The constant is larger, the reflection is larger.
The dielectric constants of Wood block and sand are sort of large, so the reflected wave exists. Especially for water, it's 61.5,
makes the multipath heavily. So we should pay much attention to working around lake or river. The reflection becomes larger when
the material becomes wet, like block, sand, soil, for the sake of increasing dielectric constants respectively. So also pay attention
to the environment, especially in rain. Of course, the multipath has some relationship with the distance between antenna and reflectors.
As attenuation happens when electromagnetic wave goes through aerosphere, the attenuation formula is:
    I = Io * e ** (-D * alpha)  (最后一页)
In it 'Io' is energy in total, 'I' is the energy the antenna gets, 'D' is optical distance, 'alpha' is attenuation coefficient.
When the reflector is 20 meters away from the antenna ('alpha' gets 0.23), the attenuation is 40dB, while it becomes 100dB when the
distance is 50 meters. At this point (50 meters distance with 100dB attenuation), the reflection can be ignore. Consequently, we need 
to choose the proper distance between antenna and surroundings according to the weather (rain or not) and the material and the formula above.


《多路径效应对 GPS 精密定位的影响及消除方法分析》 实际上说的是信噪比消除
不确定的  天线增益 (gain of antenna??)
Yang Tianshi tried to walk on another way, which is signal-noise-ratio. In his research, he talked about the SNR (signal-noise-ratio) mainly in the realm
of swing, not in energy. To suppress multipath, SNR is a pragmatic post-processing method. Christopher . T . Comp first got this new idea in 1996. 
Phase difference is more sensitive than SNR to the position of antenna, so that analyzing SNR is a way to estimate the measurement error. 
    The antenna can receive and send signals. Whatever receiving or sending, the character coefficients won't change. SNR is one of them. From it's name 
we know that it's signal / noise. There are lots of factors effect SNR, such as multipath strength, gain character of antenna, devices status in track 
loop inside receiver.
    The PLL loop tracks the compound signal, according to the theory of electromagnetic wave, signal can be expressed as complex form:
        r = Ae ** j
A is swing; 'fai' is signal phase; J is unit of complex number. Normally ai is always small for the multipath signal, as mentioned by [6]
    formula group 1
A0 is the stable swing part inside direct signal, Aa is the so called standard gain of antenna.
    GPS receiver records signal as well as SNR. Here use SNRA instead of SNR, to express the multipath signal-noise-ratio, while SNRAd as the direct
signal-noise-ratio, according to [6]:
    formula group 2
So that we can figure out the influence on carrier wave phase by multipath ('delta''fai'), if we figure out SNRAd and SNRAm from SNRA. To achieve that
(figure out the multipath part from total SNR got by receiver), need to assume that 
    1) Ignore atmosphere refraction, so the swing of direct and multipath signal are unchanged;
    2) The movemnet of gain of antenna is contiuous and smooth in space, and is insensitive to the variety of satellite vertical angle and direction angle;
    3) Frequency of multipath is stable during a period. That's to say that the multipath could be there for a while in order to be figured out and 
corrected by us.
Combine these assuptions and formula group 1 and 2, we get:
    formula 3
Different antennae have different gain. We can't figure out SNRAd precisely only by gain of antenna. From assuption 2 above, if the differences between
every adjacent epochs are not too large, regarding every SNRAd of two adjacent epochs is ok. Substraction between every two adjacent epochs can eliminate
the direct signal:
    formula 4 (this time not group, only 1)
From that we get 'alpha'i * Ao * cos'fai'i, they are multipath swings of every epochs. As multipaths are independent to each other, the influence on
compound signal is algebraic sum, not simple adding:
    formula again
After getting the total multipath swing, with what we've got in receiver, according to formula group 1 and 3, consequently SNRAd is out of water.
    The author then used two ASHTECH receivers and corresponding processing software called 'solutions' to experiment, one in flat ground (nearest 
reflector is at least 50 meters away), one just close to a tall wall. So the multipath is a high-frequency item for the former (period is 30 ~ 40
seconds), while low-frequency item for the latter (period is 0.3 ~ 1 hour). For the former the multipath could be regarded as noise in data processing,
but for the latter correction for baseline must take place. First apply the original data without multipath correction to 'solutions' to calculate baseline
vectors. The precision of the resulting baseline is inaccurate, difference of residual phase is kind of huge, from the baseline diagram and satellite
residual phase diagram. After corrected by SNR method, residual phases are all pushed down, the maximum is less than 0.15 period, meanwhile baseline
precision is highly improved.


《GPS 动态监测中多路径效应的规律性研究》
Huang Shengxiang, Li Peihong, Yang Baocen, Xiang Dong did a research of applying filtering and all-day-substraction to multipath effects. Multipath 
effects may differ from time to time, illustrating periodicity, from multi-seconds to multi-minutes. If the receiver is at a standstill, and surroundings are both unchanged, multipath effects
will happen again and again. Based on that, contiuous observations may eliminate the effects. 
    They set two double-frequency receivers, one is base station, one is observation station in dynamic position mode, sampling per second. Satellite
vertical angle is 13 degree. Collect more than 2 days' data with antenna position, observation mode and weather unchanged. Diagram 2 and 3 are average 
3-dimension time-histories' diagrams, for the first day and the second respectively. We may find that the curves have same trend, so that the positioning
results have systematic error. According to all-day track variety of satellite, time of the second day should be 236 seconds former than the first. Apply
substraction on the corresponding data in the two days, we get diagram 4 which is the differences. It's so clearly that the curve is more smooth, implies
that the systematic error has already been dropped. However it's not flat, since there is still accidental error, which can't be moved away in this way.
To avoid accidental error, first use Daubechies wavelet to filter, then all-day-substraction. Table 2 is the result after wavelet filtering. We can see
that the low-frequency errors which mainly based on multipath are not suppressed well, because of it's fluctuation. Vertical precision is about twice
as much as horizontal precision. After all-day-substraction, precision improved in 3 dimensions. Compared with table 1 and 2, horizontal precision has
been boosted one time. This illustrats that combine filtering and all-day-substraction can highly improve positioning precision.

< Fianl conclusion>
There are a lot of reasons to cause errors on GPS, multipath is the significant. Only way to improve the quality of GPS signals is multipath suppressing.
There also a lot of methods dealing with multipath, hardware improvement and post-processing in conclusion. But it's complex and a hard way, since it 
has messy relationship with environment, antenna characters, reflectors, distance between reflector and antenna and so forth. Nowadays it's still not
mature, so it's a long way to improve the error correction in future. We can imagine that the future of GPS is big and wonderful if multipath could be 
controled well which leading to a better precision of positioning.

[6]施闯 ,刘经南 ,姚宜斌 . 高精度 GPS 网数据处理中的系统误差分析 . 武汉大学学报 (信息科学版) ,2002 ,27 (2), the formula is:
